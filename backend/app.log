2020-06-01 01:12:06.966 ERROR 8180 --- [http-nio-8080-exec-9] c.t.a.b.exception.SqlExceptionHandler    : org.springframework.dao.DuplicateKeyException: PreparedStatementCallback; SQL [INSERT INTO user_to_ach (user_id, ach_id) (SELECT ? as user_id, A.id as ach_id FROM achievement A LEFT OUTER JOIN (SELECT A.title, COUNT(QTC.cat_id) AS played FROM user_to_ses US INNER JOIN session S ON US.ses_id = S.id INNER JOIN quiz_to_categ QTC ON QTC.quiz_id = S.quiz_id INNER JOIN achievement A ON A.cat_id = QTC.cat_id WHERE US.user_id = ? GROUP BY QTC.cat_id, A.title) AS UA ON A.title = UA.title WHERE UA.played >= A.quiz_amount)]; ERROR: duplicate key value violates unique constraint "user_to_ach_pkey"
  Подробности: Key (user_id, ach_id)=(28, 5) already exists.; nested exception is org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "user_to_ach_pkey"
  Подробности: Key (user_id, ach_id)=(28, 5) already exists.
2020-06-01 01:21:33.302  INFO 8180 --- [SpringContextShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler     : Stopping...
2020-06-01 01:21:33.337  INFO 8180 --- [SpringContextShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler     : BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [DefaultSubscriptionRegistry[cache[0 destination(s)], registry[0 sessions]]]]
2020-06-01 01:21:33.357  INFO 8180 --- [SpringContextShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler     : Stopped.
2020-06-01 01:21:33.372  INFO 8180 --- [SpringContextShutdownHook] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'brokerChannelExecutor'
2020-06-01 01:21:33.417  INFO 8180 --- [SpringContextShutdownHook] o.s.s.c.ThreadPoolTaskScheduler          : Shutting down ExecutorService 'messageBrokerTaskScheduler'
2020-06-01 01:21:33.433  INFO 8180 --- [SpringContextShutdownHook] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'clientOutboundChannelExecutor'
2020-06-01 01:21:33.447  INFO 8180 --- [SpringContextShutdownHook] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'clientInboundChannelExecutor'
